<!DOCTYPE html>
<html>
  <head>
    <title>Islanders</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=DynaPuff:wght@400..700&display=swap');
      body {
        font-family: "DynaPuff", cursive;
        margin: 0;
        width: 100vw;
        min-height: 100vh;
        overflow-x: hidden; 
        background-color: #4296ce; 
        color: rgb(86, 57, 7);
      }
      h1 {
        font-family: "DynaPuff", cursive;
        font-size: 10vh;
        color: rgb(57, 41, 6);
      }
      .background {
        position: fixed;
        inset: 0;
        background: url("https://summer.hackclub.com/assets/map_sea_background.jpg") center/cover no-repeat;
        opacity: 0.28;
        z-index: -1; 
        pointer-events: none;
      }
      .content {
        padding: 40px;
        max-width: 800px;
        margin: auto;
      }
      .map-container {
        position: relative;
        width: 100%;
        margin: 40px 0;
      }
      .map-container img {
        width: 100%;
        height: auto; 
        object-fit: contain;
        background-color: #4997ca; 
        user-select: none;
        pointer-events: none;
        display: block;
      }
      #dots {
        position: absolute;
        inset: 0;
      }
      .dot {
        position: absolute;
        width: 16px;
        height: 16px;
        background: red;
        border: 2px solid white;
        border-radius: 50%;
        cursor: pointer;
        transform: translate(-50%, -50%);
        transition: transform 0.2s ease;
      }
      .dot:hover {
        transform: translate(-50%, -50%) scale(1.3);
      }
      .marble-button {
        position: relative;
        background: #d4c4b0;
        border: 3px solid #a8956b;
        border-radius: 12px;
        padding: 10px 20px;
        cursor: pointer;
        font-weight: 700;
        color: #3a2f25;
        transition: all 0.15s ease;
        box-shadow: 0 6px 0 #8b7a54, 0 8px 15px rgba(0, 0, 0, 0.2);
        transform: translateY(0);
      }
    </style>
  </head>
  <body>
    <div class="background"></div>

    <div class="content">
     <h1>Welcome Islander!</h1>
      <p>
        Create your own space on the summer of making island! Join the community of islanders by publishing a website, get it hosted here and compete for an ipad!
        <br>check out the projects on the map below, or scroll to find out how you can submit
      </p>
    </div>

    <div class="map-container">
      <img src="https://summer.hackclub.com/assets/map_new-04857e1f.jpg" alt="The Map">
      <div id="dots"></div>
      <p><button class="marble-button" id="randomButton" style="display: block; margin: 0 auto;">Take Me Somewhere Random</button></p>
    </div>

    <div class="content">
      <p><u><b>what should i put on my website?</b></u></p>
      <p style="margin-left: 2em; line-height: 1.6;">
        -A short story about something that happened there (optional)<br>
        -A cute background image showing where you are (can be AI generated)<br>
        -An artifact found on the island? (optional)<br>
        -A little information about yourself<br>
        -A link to this page<br>
        -A link to another islanders site!
      </p>
      <br><br>
      <p><u><b>How do I make my space?</b></u></p>
      <p style="margin-left: 2em; line-height: 1.6;">
        -Create an HTML file<br>
        -add content, stylise with css and add behaviours with JS<br>
        -be sure to track your hours with hackatime in a code editor<br>
        -My personal recomendation is VS code using the "live server" extension to view the site<br>
        -Use the submit form to place it on the map and upload the file<br>
        -I'll review it and add it to the map!<br>
        -The most interesting site will win an ipad!
      </p>
    </div>
    <a class="marble-button" href="https://forms.hackclub.com/islanders" id="submit" style="display: block; margin: 20px auto 40px auto; font-size: 1.2em; width: 10vw; text-decoration: none;">SUBMIT!</a>

<script>
  const button = document.getElementById('randomButton');
  const dotsContainer = document.getElementById('dots');

  async function loadSubmissions() {
    try {
      const res = await fetch('/submissions.json');
      const submissions = await res.json();

      // Render dots using coords
      submissions.forEach(sub => {
        if (Array.isArray(sub.coords) && sub.coords.length === 2 && sub.file) {
          const [x, y] = sub.coords; // coords[0] = left %, coords[1] = top %

          const dot = document.createElement('div');
          dot.className = 'dot';
          dot.style.left = x + "%";
          dot.style.top = y + "%";

          dot.title = sub.name; // tooltip with the name

          dot.addEventListener('click', () => {
            window.location.href = `/view?file=${encodeURIComponent(sub.file)}`;
          });

          dotsContainer.appendChild(dot);
        }
      });

      // Random button
      button.addEventListener('click', () => {
        if (!Array.isArray(submissions) || submissions.length === 0) {
          console.log("No submissions found!");
          return;
        }
        const random = submissions[Math.floor(Math.random() * submissions.length)];
        const filePath = random.file;
        window.location.href = `/view?file=${encodeURIComponent(filePath)}`;
      });

    } catch (err) {
      console.error("Error loading submissions.json", err);
      alert("Could not load submissions list.");
    }
  }

  loadSubmissions();
</script>

  </body>
</html>
